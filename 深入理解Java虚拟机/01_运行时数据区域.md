#  01_运行时数据区域

![image-20200314220303298](C:\Users\Peter\AppData\Roaming\Typora\typora-user-images\image-20200314220303298.png)



## 程序计数器

***线程私有***

程序计数器（Program Counter Register）是一块较小的内存空间，它可以看作是当前线程所执行的***字节码的行号指示器***。循环、跳转、线程恢复等基础功能都依赖这个计数器完成。此区域是唯一一个在《Java虚拟机规范》中没有规定OutOfMemoryError的区域。

**注意：**若程序正在执行的是本地（Native）方法，这个计数器值应为Undefined。



## Java虚拟机栈

***线程私有***

Java虚拟机栈（Java Virtual Machine Stack）的生命周期与线程相同。

每个方法执行的时候，Java虚拟机都会同步创建一个栈帧（Stack Frame）用于***存储局部变量表、操作数栈、动态连接、方法出口***等信息。

局部变量表存放了编译期可知的各种Java虚拟机***基本数据类型***（boolean、byte、char、short、int、float、long、double）、对象引用（reference类型，它并不等同于对象本身，可能是一个指向对象起始地址的引用指针，也可能是指向一个代表对象的句柄或者其他与此对象相关的位置）和returnAddress类型（指向了一条字节码指令的地址）。

这些数据类型在局部变量表中的存储空间以***局部变量槽***（Slot）来表示，其中64位长度的long和double类型的数据会占用两个变量槽，其余的数据类型只占用一个。局部变量表所需的内存空间在***编译期间完成分配***。一个变量槽可能占用32比特或64比特，由虚拟机自行决定。

在《Java虚拟机规范》中，对这个内存区域规定了两类异常状况：如果线程请求的栈深度大于虚拟机所允许的深度，将抛出***StackOverflowError***异常；如果Java虚拟机栈容量可以动态扩展，当栈扩展时无法申请到足够的内存会抛出***OutOfMemoryError***异常。